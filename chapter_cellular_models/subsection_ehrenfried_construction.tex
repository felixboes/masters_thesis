\subsection{Construction of the Ehrenfried Complex}
We proceed as indicated in Section \ref{cellular_models:introduction}.
A brief review on factorable groups can be found in Appendix \ref{notation:factorable_groups}.
Here, we use some basic tools from group homology which are introduced in \cite{Brown198211}.
Further, we assume that the reader is used to work with spectral sequences.
There are several introductions to the theory of spectral sequences and we recommend working through \cite[Chapter 5]{Weibel1995} or \cite[Chapter 9]{Spanier199412}.

Denote by $E$ the spectral sequence associated with the vertical homology of the double complex $P/P'$.
Observe that $P/P'$ vanishes if the vertical degree is larger then $h$.
\begin{defthm}
    \label{cellular_models:ehrenfried:E1_is_concentrated_in_a_single_row}
    \symbolindex[k]{$\KK_\bullet$}{The top row of the first page of the spectral sequence associated with the vertical homology of the double complex $P/P'$ respectively $R/R'$.}{Definition / Theorem \ref{cellular_models:ehrenfried:E1_is_concentrated_in_a_single_row}}
    \symbolindex[d]{$\del_\KK$}{The boundary operator of the complex $\KK$.}{Definition / Theorem \ref{cellular_models:ehrenfried:E1_is_concentrated_in_a_single_row}}
    The first page of the spectral sequence $E$ is concentrated in the $h\Th$ row
    \[
        \KK_\bullet = E^1_{\bullet,h} = \ker( \del'_{\bullet,h})\,. 
    \]
\end{defthm}

\begin{proof}
\label{page:bar_resulution_of_sym_grp}%
\index{symmetric group!bar resolution of the symmetric group}
\symbolindex[b]{$B_\bullet(\Symgrp^\times_p)$}{The bar resolution of the symmertric group.}{Page \pageref{page:bar_resulution_of_sym_grp}}
Consider the bar resolution $B_\bullet(\Symgrp^\times_p)$ of the symmertric group $\Symgrp^\times_p = Aut(\{1, \ldots, p\})$ and
let $N$ denote the word length norm with respect to the generating set of all transpositions.
\label{page:norm_filtration}%
\index{norm filtration}
\symbolindex[f]{$F_pB_q$}{The norm filtration of the bar resolution of the symmertric group.}{Page \pageref{page:norm_filtration}}
This norm induces a filtration
\[
    F_tB_q = \langle \inhomq[g] \mid N(g_q) + \ldots + N(g_1) \le t \rangle \,
\]
on the bar resolution.
\label{page:norm_complex}%
\index{norm complex}
\symbolindex[n]{$\Ncplx[\Symgrp^\times_p]$}{The spectral sequence associated with the norm filtration called norm complex}{Page \pageref{page:norm_complex}}
The spectral sequence associated with this filtration is by definition the norm complex $\Ncplx[\Symgrp^\times_p]$ with zero$\Th$ term $\Ncplx^0[\Symgrp^\times_p]_{t,q} = F_tB_q / F_{t-1}B_q$.
We refere to the following theorem.
\begin{thm}[\cite{Visy201011} Theorem 4.1.1 and Theorem 5.2.1]
    The symmetric group with the above norm is factorable.
    The homology of $\Ncplx^0[\Symgrp^\times_p]_{\bullet,h}$ is therefore concentrated in the top degree $\bullet = h$.
\end{thm}

It remains to show that for fixed $p$, $E_\bullet = E^0_{p,\bullet}$ is a direct summand of $\Ncplx[\Symgrp^\times_p]^0_{\bullet,h}$.
As a module, $\Ncplx[\Symgrp^\times_p]_{q,h}$ is freely generated by all $\inhomq[g]$ with
\begin{enumerate}
    \item \label{cellular_models:ehrenfried:cells_in_norm_complex:non_trivial}$1 \neq g_j \in \Symgrp^\times_p$ for all $j$ and
    \item \label{cellular_models:ehrenfried:cells_in_norm_complex:norm}$N(g_q) + \ldots + N(g_1) = h$.
\end{enumerate}
The module $E_q$ is freely generated by all non-degenerate cells.
Using the inhomogenous notation, 
$E_q$ is hence freely generated by all $\Sigma = \inhomq[g]$ with
\begin{enumerate}
    \item $1 \neq g_j \in \Symgrp^\times_p$ for all $j$,
    \item $N(g_q) + \ldots + N(g_1) = h$,
    \item the $g_q, \ldots, g_1$ do not have a common fixed point,
    \item $m = m(\Sigma)$ and $n = n(\Sigma)$,
    \item the levels of $\Sigma$ are ordered ascendingly with respect to the partition $(r_1, \ldots, r_n)$ and
    \item $\Sigma$ is connected.
\end{enumerate}

A direct computation shows that the canonical inclusion $E_\bullet \xhr{} \Ncplx[\Symgrp^\times_p]_{\bullet,h}$ of modules induces a chain monomorphism that splits
as the latter four conditions are invariant under $\del^{\Ncplx[\Symgrp^\times_p]}$.
\end{proof}

\begin{cor}
    \label{cellular_models:ehrenfried:KK_is_qi_subcomplex}
    The canonical inclusion of the chain complex $\KK_\bullet$ into the top row of $P/P'$ defines a quasi-isomorphism
    \[
        \KK_\bullet \xhr{\simeq} Tot(P/P')_{\bullet + h} \,.
    \]
\end{cor}

\begin{proof}
    The canonical inclusion $\KK_p \to Tot(P/P')_{p,h}$ defines a chain map since $\KK = \ker( \del'_{\bullet,h} )$.
    From the preceding Theorem \ref{cellular_models:ehrenfried:E1_is_concentrated_in_a_single_row}, we obtain
    $H_\ast(\KK) = E^2_{\ast,h} = H_{\ast+h}(P,P')$.
\end{proof}

Let us construct an distinguished basis for $\KK_\bullet$.
In order to do so, recall the definition of the factorization map $\eta$ (discussed in Appendix \ref{notation:factorization_map}).
It splits a permutation $\alpha$ into $\alpha = \ov \alpha \alpha'$ with $\alpha' = ( c\ \alpha^{-1}(c))$ where $c = \height(\alpha)$.

\begin{defi}
    \label{cellular_models:ehrenfried:mueta}
    \index{mueta}
    \symbolindex[1]{$\mueta$ or $\mueta_j$}{The map mueta multiplies two permutations and factors their product via the factorization map $\eta$ afterwards.}{Definition \ref{cellular_models:ehrenfried:mueta}}
    For an arbitrary cell $\Sigma = \inhomq$ of bidegree $(p,q)$ and $q > j \ge 1$, let
    \[
        \mueta_j (\Sigma) = (\tau_q \mid \ldots \mid \ov{\tau_{j+1}\tau_j} \mid (\tau_{j+1}\tau_j)' \mid \ldots \mid \tau_1) \,.
    \]
    In other words, the map $\mueta_j$ considers the $j\Th$ vertical face of $\Sigma$ by multiplying $\tau_j$ with $\tau_{j+1}$,
    and then factors this product via the factorization map from above.
    Consequently, the symbol $\mueta = \eta\mu$ should remind us of this process and is therefore called {\bfseries mueta}.
\end{defi}

\begin{defi}
    \label{cellular_models:ehrenfried:definition_kappa}
    \index{kappa}
    \symbolindex[k]{$\kappa$}{The homomorphism kappa encodes the base change from $\KK_\bullet$ to the Ehrenfried complex.}{Definition \ref{cellular_models:ehrenfried:definition_kappa}}
    We define the homomorphism $\kappa$ by extending
    \[
        \kappa = \kappa_h = K_h \circ \ldots \circ K_1
    \]
    linearly, where
    \[
        K_q = \sum_{j=1}^q (-1)^{q-j} \Phi_{j}^q
    \]
    and
    \[
        \Phi_j^q = \mueta_j \circ \ldots \mueta_{q-1} \,.
    \]
\end{defi}

\begin{defi}
    \label{cellular_models:ehrenfried:definition:cells}
    \index{cell!monotonous cell}
    As a module, let $\E_p$ be freely generated by all top dimensional, non-degenerate cells $\Sigma = \inhom$ that are monotonous, i.e.\
    \[
        \height(\tau_h) \ge \ldots \ge \height(\tau_1) \,.
    \]
\end{defi}

\begin{lem}
    \label{cellular_models:ehrenfried:kappa_is_basechange}
    The map $\kappa \colon \E_p \to \KK_p$ is an isomorphism of modules.
\end{lem}

\begin{proof}
    In order to prove this, we use the notation introduced in the proof of Theorem \ref{cellular_models:ehrenfried:E1_is_concentrated_in_a_single_row}.
    Due to Visy's work on factorable groups \cite[Theorem 5.4.1]{Visy201011} -- which was generalized to factorable monoids due to \cite[Proposition 3.3.6]{Hess2012} --,
    there is a homomorphism of modules
    \[
        \mathbb V_p \xr{\kappa} \Ncplx^1[\Symgrp^\times_p]_{h,h} \mspc{is inverse to}{20} \Ncplx^1[\Symgrp^\times_p]_{h,h} \xr{\pi} \mathbb V_p \,,
    \]
    \label{page:visy_complex}%
    \symbolindex[v]{$\V$}{The so-called Visy complex.}{Page \pageref{page:visy_complex}}
    where $\mathbb V_p$ is freely generated by all top dimensional, monotonous cells and $\pi$ is the projection onto the monotonous ones.
    By construction, $E^0_{p,\bullet} \subseteq \Ncplx^0[\Symgrp^\times_p]_{\bullet,h}$ has a direct complement $C_\bullet$ that
    is freely generated by all cells that satisfy conditions \ref{cellular_models:ehrenfried:cells_in_norm_complex:non_trivial} and \ref{cellular_models:ehrenfried:cells_in_norm_complex:norm} but
    violate at least one of the other conditions (c.f.\ \ref{cellular_models:ehrenfried:E1_is_concentrated_in_a_single_row}).
    In particular, we have
    \[
        \KK_p \oplus H_h(C_\bullet) = H_h(E^0_{p,\bullet})\oplus H_h(C_\bullet) \cong \Ncplx^1[\Symgrp^\times_p]_{h,h}
    \]
    since $\KK_p = H_h(E^0_{p,\bullet})$ by Definition \ref{cellular_models:ehrenfried:E1_is_concentrated_in_a_single_row}.
    The module $\E_p \subset \V_p$ has a direct complement $D_p$ which is freely generated by all top dimensional
    that satisfy the first three conditions in Definition \ref{cellular_models:parallel:parallel_slit_complex} but are not non-degenerate --- which is not equivalent to being degenerate.
    Now the claim follows from
    \[
        \pi(\KK_p) \subseteq \E_p \mspc{and}{20} \pi(H_h(C)) \subseteq D_p
    \]
    as all modules are finite dimensional.
\end{proof}

\begin{defi}
    \label{cellular_models:Ehrenfried:defi}
    \symbolindex[d]{$\del_\E$}{The boundary operator of the Ehrenfried complex}{Definition \ref{cellular_models:Ehrenfried:defi}}
    The chain modules $\E_p$ of the Ehrenfried complex $(\E, \del_\E)$ are freely generated by all top-dimensional non-degenerate cells.
    The boundary maps $\del_\E = \pi \circ \del'' \circ \kappa$ make the diagram
    \[
        \begin{tikzcd}
            \E_p \arrow{r}{\del_\E} \arrow{d}{\kappa}[swap]{\cong}      & \E_{p-1} \\
            \KK_p \arrow{r}{\del''}                                     & \KK_{p-1} \arrow{u}{\cong}[swap]{\pi}
        \end{tikzcd}
    \]
    commutative.
    If we want to distinguish the parallel case from the radial case, we write $\Ehrr$ respectively $\E(h,m,n)$.
\end{defi}

\begin{thm}
    \label{cellular_models:Ehrenfried:Ehrenfried_dual_is_quasi_isomorphic}
    The dual Ehrenfried complex is a quasi-isomorphic direct summand of (the total complex of) $(P/P')^\ast$, respectively $(R,R')^\ast$.
    In particular the homology of the moduli space is by Poincaré duality
    \[
        H_\ast (\Modspc; \Z) \cong H^{2h-\ast}( \Ehrr; \mc O ) \mspc{with}{20} h = 2g-2+m+n+r \,,
    \]
    respectively
    \[
         H_\ast (\ModspcRad; \Z) \cong H^{2h+n-\ast}( \E(h,m); \mc O ) \mspc{with}{20} h = 2g-2+m+n \,.
    \]
\end{thm}

\begin{proof}
    The Ehrenfried complex is a quasi-isomorphic direct subcomplex of $Tot(P/P')$ as it is isomorphic to $\KK$ (compare Corollary \ref{cellular_models:ehrenfried:KK_is_qi_subcomplex}).
    The projection onto the monotonous cells $\pi \colon Tot(P/P') \to \E$ is a retraction to $\kappa$, so $\E \xhr{} Tot(P/P')$ is a quasi-isomorphism.
    After dualizing, $\pi^\ast \colon \E^\ast \xhr{} Tot(P/P')^\ast$ is the canonical inclusion with retraction $\kappa^\ast$.
    By naturality of the universal coefficient theorem, $\E^\ast \xhr{} Tot(P/P')^\ast$ is also a quasi-isomorphism.
\end{proof}
